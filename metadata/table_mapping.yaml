databases:
  - name: sqlserver_migration
    source_type: sqlserver
    source_db: "DSN=sqlserver_source"
    target_db: "postgresql://user:pass@host/db"
    enabled: true

    tables:
      # 1) EXISTING TABLE â†’ TABLE (unchanged behavior)
      - source: dbo.component_tool_mapping
        dest: public.component_mapping
        columns: [ id, component_id, mapping_type, tool_type, identifier, name, web_url, created_at ]
        sort_columns: [created_at, id]   # table path uses OFFSET
        group_by: ["Component Id", "Mapping Type"]
        where: "mapping_type IN ('it_business_application','version_control','work_management')"
        enabled: true
        odbc_extra: "Encrypt=no;TrustServerCertificate=yes;MARS_Connection=Yes;Connection Timeout=60;Login Timeout=30;Packet Size=32767"
        inline_paging: true
        # NEW (optional): runs BEFORE recreate
        pre_ddl_file: "metadata/sql/pre_component_mapping.sql"
        # As before: executed AFTER recreate, BEFORE copy
        post_ddl_file: "metadata/sql/component_mapping_repo_id.sql"
        transforms:
          plugins:
            - "metadata.transformers.component_mapping_repo_id.extract_git_coordinates"


